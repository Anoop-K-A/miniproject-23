{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/lib/roles.ts"],"sourcesContent":["export type UserRole = \"faculty\" | \"auditor\" | \"staff-advisor\";\r\n\r\nexport const ROLE_PATHS: Record<UserRole, string> = {\r\n  faculty: \"/faculty\",\r\n  auditor: \"/auditor\",\r\n  \"staff-advisor\": \"/staff-advisor\",\r\n};\r\n\r\nexport const VALID_ROLES: UserRole[] = [\"faculty\", \"auditor\", \"staff-advisor\"];\r\n\r\nexport function getDashboardPath(role: UserRole) {\r\n  return `${ROLE_PATHS[role]}/dashboard`;\r\n}\r\n\r\nexport function isValidRole(role: string | undefined | null): role is UserRole {\r\n  return role ? VALID_ROLES.includes(role as UserRole) : false;\r\n}\r\nexport function getRoleFromPath(pathname: string): UserRole | null {\r\n  if (pathname.startsWith(ROLE_PATHS.faculty)) {\r\n    return \"faculty\";\r\n  }\r\n  if (pathname.startsWith(ROLE_PATHS.auditor)) {\r\n    return \"auditor\";\r\n  }\r\n  if (pathname.startsWith(ROLE_PATHS[\"staff-advisor\"])) {\r\n    return \"staff-advisor\";\r\n  }\r\n  return null;\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAEO,MAAM,aAAuC;IAClD,SAAS;IACT,SAAS;IACT,iBAAiB;AACnB;AAEO,MAAM,cAA0B;IAAC;IAAW;IAAW;CAAgB;AAEvE,SAAS,iBAAiB,IAAc;IAC7C,OAAO,GAAG,UAAU,CAAC,KAAK,CAAC,UAAU,CAAC;AACxC;AAEO,SAAS,YAAY,IAA+B;IACzD,OAAO,OAAO,YAAY,QAAQ,CAAC,QAAoB;AACzD;AACO,SAAS,gBAAgB,QAAgB;IAC9C,IAAI,SAAS,UAAU,CAAC,WAAW,OAAO,GAAG;QAC3C,OAAO;IACT;IACA,IAAI,SAAS,UAAU,CAAC,WAAW,OAAO,GAAG;QAC3C,OAAO;IACT;IACA,IAAI,SAAS,UAAU,CAAC,UAAU,CAAC,gBAAgB,GAAG;QACpD,OAAO;IACT;IACA,OAAO;AACT"}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { getDashboardPath, getRoleFromPath, isValidRole } from \"@/lib/roles\";\r\n\r\nexport function middleware(request: NextRequest) {\r\n  const { pathname } = request.nextUrl;\r\n\r\n  // Get auth from cookies (set on login)\r\n  const isAuthenticated =\r\n    request.cookies.get(\"auth_authenticated\")?.value === \"true\";\r\n  const userRole = request.cookies.get(\"auth_role\")?.value;\r\n\r\n  const isLoginRoute = pathname === \"/login\" || pathname === \"/register\";\r\n  const isRootRoute = pathname === \"/\";\r\n\r\n  if (isLoginRoute) {\r\n    if (isAuthenticated && isValidRole(userRole)) {\r\n      return NextResponse.redirect(\r\n        new URL(getDashboardPath(userRole), request.url),\r\n      );\r\n    }\r\n    return NextResponse.next();\r\n  }\r\n\r\n  if (isRootRoute) {\r\n    if (isAuthenticated && isValidRole(userRole)) {\r\n      return NextResponse.redirect(\r\n        new URL(getDashboardPath(userRole), request.url),\r\n      );\r\n    }\r\n    return NextResponse.redirect(new URL(\"/login\", request.url));\r\n  }\r\n\r\n  const routeRole = getRoleFromPath(pathname);\r\n  if (routeRole) {\r\n    if (!isAuthenticated) {\r\n      return NextResponse.redirect(new URL(\"/login\", request.url));\r\n    }\r\n\r\n    if (!isValidRole(userRole)) {\r\n      return NextResponse.redirect(new URL(\"/login\", request.url));\r\n    }\r\n\r\n    if (userRole !== routeRole) {\r\n      return NextResponse.redirect(\r\n        new URL(getDashboardPath(userRole), request.url),\r\n      );\r\n    }\r\n  }\r\n\r\n  return NextResponse.next();\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\r\n    /*\r\n     * Match all request paths except for the ones starting with:\r\n     * - api (API routes)\r\n     * - _next/static (static files)\r\n     * - _next/image (image optimization files)\r\n     * - favicon.ico (favicon file)\r\n     */\r\n    \"/((?!api|_next/static|_next/image|favicon.ico).*)\",\r\n  ],\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEO,SAAS,WAAW,OAAoB;IAC7C,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,uCAAuC;IACvC,MAAM,kBACJ,QAAQ,OAAO,CAAC,GAAG,CAAC,uBAAuB,UAAU;IACvD,MAAM,WAAW,QAAQ,OAAO,CAAC,GAAG,CAAC,cAAc;IAEnD,MAAM,eAAe,aAAa,YAAY,aAAa;IAC3D,MAAM,cAAc,aAAa;IAEjC,IAAI,cAAc;QAChB,IAAI,mBAAmB,IAAA,0IAAW,EAAC,WAAW;YAC5C,OAAO,gMAAY,CAAC,QAAQ,CAC1B,IAAI,IAAI,IAAA,+IAAgB,EAAC,WAAW,QAAQ,GAAG;QAEnD;QACA,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,IAAI,aAAa;QACf,IAAI,mBAAmB,IAAA,0IAAW,EAAC,WAAW;YAC5C,OAAO,gMAAY,CAAC,QAAQ,CAC1B,IAAI,IAAI,IAAA,+IAAgB,EAAC,WAAW,QAAQ,GAAG;QAEnD;QACA,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;IAC5D;IAEA,MAAM,YAAY,IAAA,8IAAe,EAAC;IAClC,IAAI,WAAW;QACb,IAAI,CAAC,iBAAiB;YACpB,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,IAAI,CAAC,IAAA,0IAAW,EAAC,WAAW;YAC1B,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;QAEA,IAAI,aAAa,WAAW;YAC1B,OAAO,gMAAY,CAAC,QAAQ,CAC1B,IAAI,IAAI,IAAA,+IAAgB,EAAC,WAAW,QAAQ,GAAG;QAEnD;IACF;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;;;;;;KAMC,GACD;KACD;AACH"}}]
}