{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/anoop/miniproject-23/src/lib/jsonDb.ts"],"sourcesContent":["import fs from \"fs/promises\";\r\nimport path from \"path\";\r\n\r\nconst dataRoot = path.join(process.cwd(), \"src\", \"data\");\r\n\r\nexport function getDataFilePath(fileName: string) {\r\n  return path.join(dataRoot, fileName);\r\n}\r\n\r\nexport async function readJsonFile<T>(fileName: string): Promise<T> {\r\n  const filePath = getDataFilePath(fileName);\r\n  const fileContents = await fs.readFile(filePath, \"utf-8\");\r\n  return JSON.parse(fileContents) as T;\r\n}\r\n\r\nexport async function writeJsonFile<T>(fileName: string, data: T) {\r\n  const filePath = getDataFilePath(fileName);\r\n  await fs.writeFile(filePath, JSON.stringify(data, null, 2));\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEA,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,OAAO;AAE1C,SAAS,gBAAgB,QAAgB;IAC9C,OAAO,4GAAI,CAAC,IAAI,CAAC,UAAU;AAC7B;AAEO,eAAe,aAAgB,QAAgB;IACpD,MAAM,WAAW,gBAAgB;IACjC,MAAM,eAAe,MAAM,gIAAE,CAAC,QAAQ,CAAC,UAAU;IACjD,OAAO,KAAK,KAAK,CAAC;AACpB;AAEO,eAAe,cAAiB,QAAgB,EAAE,IAAO;IAC9D,MAAM,WAAW,gBAAgB;IACjC,MAAM,gIAAE,CAAC,SAAS,CAAC,UAAU,KAAK,SAAS,CAAC,MAAM,MAAM;AAC1D"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/anoop/miniproject-23/src/app/api/auth/register/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { readJsonFile, writeJsonFile } from \"@/lib/jsonDb\";\r\nimport type { UserRole } from \"@/lib/roles\";\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { email, password, fullName, role, department } =\r\n      await request.json();\r\n\r\n    // Validate inputs\r\n    if (!email || !password || !fullName || !role || !department) {\r\n      return NextResponse.json(\r\n        { error: \"All fields are required\" },\r\n        { status: 400 },\r\n      );\r\n    }\r\n\r\n    if (password.length < 6) {\r\n      return NextResponse.json(\r\n        { error: \"Password must be at least 6 characters\" },\r\n        { status: 400 },\r\n      );\r\n    }\r\n\r\n    const users = await readJsonFile<any[]>(\"users.json\");\r\n\r\n    // Check for duplicate email\r\n    if (users.some((user: any) => user.username === email)) {\r\n      return NextResponse.json(\r\n        { error: \"Email already exists\" },\r\n        { status: 400 },\r\n      );\r\n    }\r\n\r\n    // Generate unique id\r\n    const id = Date.now().toString();\r\n    const normalizedRole: UserRole =\r\n      role === \"Auditor\"\r\n        ? \"auditor\"\r\n        : role === \"StaffAdvisor\" || role === \"Staff Advisor\"\r\n          ? \"staff-advisor\"\r\n          : \"faculty\";\r\n\r\n    const timestamp = new Date().toISOString();\r\n\r\n    const newUser = {\r\n      id,\r\n      username: email,\r\n      password,\r\n      name: fullName,\r\n      role: normalizedRole,\r\n      department,\r\n      status: normalizedRole === \"faculty\" ? \"pending\" : \"active\",\r\n      createdAt: timestamp,\r\n      updatedAt: timestamp,\r\n    };\r\n\r\n    // Save user\r\n    users.push(newUser);\r\n    await writeJsonFile(\"users.json\", users);\r\n\r\n    return NextResponse.json({ message: \"User created successfully\" });\r\n  } catch (error) {\r\n    console.error(\"Register error:\", error);\r\n    return NextResponse.json(\r\n      { error: \"Internal server error\" },\r\n      { status: 500 },\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,UAAU,EAAE,GACnD,MAAM,QAAQ,IAAI;QAEpB,kBAAkB;QAClB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,YAAY,CAAC,QAAQ,CAAC,YAAY;YAC5D,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,SAAS,MAAM,GAAG,GAAG;YACvB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAyC,GAClD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,MAAM,IAAA,sIAAY,EAAQ;QAExC,4BAA4B;QAC5B,IAAI,MAAM,IAAI,CAAC,CAAC,OAAc,KAAK,QAAQ,KAAK,QAAQ;YACtD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,qBAAqB;QACrB,MAAM,KAAK,KAAK,GAAG,GAAG,QAAQ;QAC9B,MAAM,iBACJ,SAAS,YACL,YACA,SAAS,kBAAkB,SAAS,kBAClC,kBACA;QAER,MAAM,YAAY,IAAI,OAAO,WAAW;QAExC,MAAM,UAAU;YACd;YACA,UAAU;YACV;YACA,MAAM;YACN,MAAM;YACN;YACA,QAAQ,mBAAmB,YAAY,YAAY;YACnD,WAAW;YACX,WAAW;QACb;QAEA,YAAY;QACZ,MAAM,IAAI,CAAC;QACX,MAAM,IAAA,uIAAa,EAAC,cAAc;QAElC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAA4B;IAClE,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}