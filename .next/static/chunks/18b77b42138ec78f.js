(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16721,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(15288),r=e.i(19455),l=e.i(93479),i=e.i(10204),n=e.i(24687),c=e.i(67489),o=e.i(84774),d=e.i(76639),m=e.i(87316),x=e.i(86536),h=e.i(27612),u=e.i(7233),p=e.i(55436),j=e.i(75254);let v=(0,j.default)("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);var g=e.i(69074);let b=(0,j.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var y=e.i(41947),y=y,N=e.i(87486),f=e.i(46696),w=e.i(77572),C=e.i(40160),S=e.i(87130),D=e.i(86311),R=e.i(29006),T=e.i(84614),A=e.i(29592),k=e.i(70568),I=e.i(72871),B=e.i(73443),F=e.i(43682);function E({reports:e,currentUser:i,onReportsChange:n}){let[h,u]=(0,t.useState)(""),[j,v]=(0,t.useState)("all"),[g,b]=(0,t.useState)("all"),[y,w]=(0,t.useState)("all"),[E,L]=(0,t.useState)(!1),[P,H]=(0,t.useState)(null),[O,z]=(0,t.useState)(!1),[M,U]=(0,t.useState)(!1),[V,q]=(0,t.useState)(null),$=async e=>{if(!P)return;let s={id:`pr${Date.now()}`,reviewerName:i,reviewDate:new Date().toISOString().split("T")[0],comment:e},t={...P,peerReviews:[...P.peerReviews||[],s]};try{let e=await fetch(`/api/event-reports/${P.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({peerReviews:t.peerReviews})}),s=await e.json();if(!e.ok)return void f.toast.error(s.error||"Peer review failed");n?.(s.reports);let a=s.reports.find(e=>e.id===P.id);H(a??t),z(!1)}catch(e){console.error("Peer review error:",e),f.toast.error("An error occurred while submitting review")}},G=async e=>{if(!P||!V)return;let s={...P,peerReviews:P.peerReviews?.map(s=>s.id===V.id?{...s,facultyResponse:e,responseDate:new Date().toISOString().split("T")[0]}:s)};try{let e=await fetch(`/api/event-reports/${P.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({peerReviews:s.peerReviews})}),t=await e.json();if(!e.ok)return void f.toast.error(t.error||"Response failed");n?.(t.reports);let a=t.reports.find(e=>e.id===P.id);H(a??s),q(null),U(!1)}catch(e){console.error("Response error:",e),f.toast.error("An error occurred while responding")}},J=e=>{switch(e){case"Approved":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";case"Submitted":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},W=e.filter(e=>{let s=e.eventName.toLowerCase().includes(h.toLowerCase())||e.facultyCoordinator.toLowerCase().includes(h.toLowerCase())||e.eventType&&e.eventType.toLowerCase().includes(h.toLowerCase()),t="all"===j||e.department===j,a="all"===g||e.status===g,r="all"===y||new Date(e.eventDate).getFullYear().toString()===y;return s&&t&&a&&r}),Y=Array.from(new Set(e.map(e=>e.department).filter(Boolean))),K=Array.from(new Set(e.map(e=>new Date(e.eventDate).getFullYear().toString()))).sort((e,s)=>parseInt(s)-parseInt(e));return(0,s.jsx)(a.Card,{children:(0,s.jsxs)(a.CardContent,{className:"pt-6 space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(p.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)(l.Input,{placeholder:"Search by event name, faculty, or type...",value:h,onChange:e=>u(e.target.value),className:"pl-10"})]}),(0,s.jsxs)(c.Select,{value:j,onValueChange:v,children:[(0,s.jsxs)(c.SelectTrigger,{className:"w-full md:w-48",children:[(0,s.jsx)(S.Filter,{className:"h-4 w-4 mr-2"}),(0,s.jsx)(c.SelectValue,{placeholder:"Department"})]}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"All Departments"}),Y.map(e=>(0,s.jsx)(c.SelectItem,{value:e,children:e},e))]})]}),(0,s.jsxs)(c.Select,{value:g,onValueChange:b,children:[(0,s.jsxs)(c.SelectTrigger,{className:"w-full md:w-48",children:[(0,s.jsx)(S.Filter,{className:"h-4 w-4 mr-2"}),(0,s.jsx)(c.SelectValue,{placeholder:"Status"})]}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"All Status"}),(0,s.jsx)(c.SelectItem,{value:"Approved",children:"Approved"}),(0,s.jsx)(c.SelectItem,{value:"Submitted",children:"Submitted"}),(0,s.jsx)(c.SelectItem,{value:"Rejected",children:"Rejected"}),(0,s.jsx)(c.SelectItem,{value:"Draft",children:"Draft"})]})]}),(0,s.jsxs)(c.Select,{value:y,onValueChange:w,children:[(0,s.jsxs)(c.SelectTrigger,{className:"w-full md:w-48",children:[(0,s.jsx)(S.Filter,{className:"h-4 w-4 mr-2"}),(0,s.jsx)(c.SelectValue,{placeholder:"Year"})]}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"All Years"}),K.map(e=>(0,s.jsx)(c.SelectItem,{value:e,children:e},e))]})]})]}),(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(o.Table,{children:[(0,s.jsx)(o.TableHeader,{children:(0,s.jsxs)(o.TableRow,{children:[(0,s.jsx)(o.TableHead,{children:"Event Name"}),(0,s.jsx)(o.TableHead,{children:"Coordinator"}),(0,s.jsx)(o.TableHead,{children:"Event Date"}),(0,s.jsx)(o.TableHead,{children:"Type"}),(0,s.jsx)(o.TableHead,{children:"Status"}),(0,s.jsx)(o.TableHead,{children:"Peer Reviews"}),(0,s.jsx)(o.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(o.TableBody,{children:0===W.length?(0,s.jsx)(o.TableRow,{children:(0,s.jsx)(o.TableCell,{colSpan:7,className:"text-center text-gray-500 py-8",children:"No event reports found matching your criteria."})}):W.map(e=>(0,s.jsxs)(o.TableRow,{children:[(0,s.jsx)(o.TableCell,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.Calendar,{className:"h-4 w-4 text-purple-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:e.eventName}),e.location&&(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.location})]})]})}),(0,s.jsx)(o.TableCell,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:e.facultyCoordinator}),e.department&&(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.department})]})}),(0,s.jsx)(o.TableCell,{children:e.eventDate}),(0,s.jsx)(o.TableCell,{children:e.eventType&&(0,s.jsx)(N.Badge,{variant:"secondary",children:e.eventType})}),(0,s.jsx)(o.TableCell,{children:(0,s.jsx)(N.Badge,{className:J(e.status),children:e.status})}),(0,s.jsx)(o.TableCell,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(D.MessageSquare,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-sm",children:e.peerReviews?.length||0})]})}),(0,s.jsx)(o.TableCell,{children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>{H(e),L(!0)},children:(0,s.jsx)(x.Eye,{className:"h-4 w-4 text-blue-600"})}),(0,s.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>{let s,t;return s=(0,F.sanitizeFileName)(e.eventName,"event-report"),t=`${s||"event-report"}.json`,void((0,F.downloadJsonFile)(e,t),f.toast.success(`Downloading ${e.eventName} report`))},children:(0,s.jsx)(C.Download,{className:"h-4 w-4"})})]})})]},e.id))})]})}),(0,s.jsx)(d.Dialog,{open:E,onOpenChange:L,children:(0,s.jsxs)(d.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(d.DialogHeader,{children:[(0,s.jsx)(d.DialogTitle,{children:"Event Report Details & Peer Review"}),(0,s.jsx)(d.DialogDescription,{children:P&&(0,s.jsxs)("span",{className:"flex items-center gap-2 mt-2",children:[(0,s.jsx)(m.Calendar,{className:"h-4 w-4"}),P.eventName]})})]}),P&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Coordinator"}),(0,s.jsx)("p",{children:P.facultyCoordinator})]}),P.department&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Department"}),(0,s.jsx)("p",{children:P.department})]}),P.eventType&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Event Type"}),(0,s.jsx)("p",{children:P.eventType})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Event Date"}),(0,s.jsx)("p",{children:P.eventDate})]}),P.location&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Location"}),(0,s.jsx)("p",{children:P.location})]}),P.participants&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Participants"}),(0,s.jsx)("p",{children:P.participants})]}),P.duration&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Duration"}),(0,s.jsx)("p",{children:P.duration})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,s.jsx)(N.Badge,{className:J(P.status),children:P.status})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[P.description&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Description"}),(0,s.jsx)("p",{className:"text-sm",children:P.description})]}),P.objectives&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Objectives"}),(0,s.jsx)("p",{className:"text-sm",children:P.objectives})]}),P.outcomes&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Outcomes"}),(0,s.jsx)("p",{className:"text-sm",children:P.outcomes})]})]}),P.adminRemarks&&(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsxs)("h4",{className:"flex items-center gap-2 mb-3",children:[(0,s.jsx)(D.MessageSquare,{className:"h-5 w-5 text-gray-600"}),"Admin Review"]}),(0,s.jsx)(A.Alert,{className:"Approved"===P.status?"border-green-200 bg-green-50":"Rejected"===P.status?"border-red-200 bg-red-50":"border-blue-200 bg-blue-50",children:(0,s.jsxs)(A.AlertDescription,{children:[(0,s.jsx)("p",{className:"text-sm mb-3",children:P.adminRemarks}),P.reviewedBy&&(0,s.jsxs)("div",{className:"text-xs text-gray-600 pt-2 border-t border-gray-200",children:[(0,s.jsxs)("p",{children:["Reviewed by: ",P.reviewedBy]}),P.reviewedDate&&(0,s.jsxs)("p",{children:["Date: ",P.reviewedDate]})]})]})})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsxs)("h4",{className:"flex items-center gap-2",children:[(0,s.jsx)(D.MessageSquare,{className:"h-5 w-5 text-gray-600"}),"Peer Reviews (",P.peerReviews?.length||0,")"]}),(0,s.jsxs)(r.Button,{size:"sm",onClick:()=>z(!0),children:[(0,s.jsx)(D.MessageSquare,{className:"h-4 w-4 mr-2"}),"Add Review"]})]}),P.peerReviews&&P.peerReviews.length>0?(0,s.jsx)(B.Accordion,{type:"single",collapsible:!0,className:"w-full border rounded-lg",children:P.peerReviews.map(e=>(0,s.jsxs)(B.AccordionItem,{value:e.id,children:[(0,s.jsx)(B.AccordionTrigger,{className:"px-4 hover:no-underline",children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full pr-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center",children:(0,s.jsx)(T.User,{className:"h-4 w-4 text-purple-600"})}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("p",{className:"font-medium",children:e.reviewerName}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.reviewDate})]})]}),e.facultyResponse&&(0,s.jsx)(N.Badge,{className:"bg-blue-100 text-blue-800 mr-2",children:"Responded"})]})}),(0,s.jsx)(B.AccordionContent,{className:"px-4",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(A.Alert,{className:"border-purple-200 bg-purple-50",children:(0,s.jsxs)(A.AlertDescription,{children:[(0,s.jsx)("p",{className:"text-xs text-purple-800 mb-2",children:"Review:"}),(0,s.jsx)("p",{className:"text-sm",children:e.comment})]})}),e.facultyResponse?(0,s.jsx)(A.Alert,{className:"border-blue-200 bg-blue-50",children:(0,s.jsxs)(A.AlertDescription,{children:[(0,s.jsxs)("p",{className:"text-xs text-blue-800 mb-2",children:["Response from"," ",P.facultyCoordinator,":"]}),(0,s.jsx)("p",{className:"text-sm",children:e.facultyResponse}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:e.responseDate})]})}):(0,s.jsx)("div",{className:"space-y-2",children:e.reviewerName===CURRENT_USER?(0,s.jsx)(A.Alert,{children:(0,s.jsxs)(A.AlertDescription,{className:"text-xs text-gray-500 italic",children:["Awaiting response from"," ",P.facultyCoordinator,"..."]})}):P.facultyCoordinator===CURRENT_USER?(0,s.jsxs)(r.Button,{variant:"outline",size:"sm",onClick:()=>{q(e),U(!0)},className:"w-full",children:[(0,s.jsx)(R.Reply,{className:"h-4 w-4 mr-2"}),"Respond to Review"]}):null})]})})]},e.id))}):(0,s.jsx)(A.Alert,{children:(0,s.jsx)(A.AlertDescription,{className:"text-sm text-gray-500",children:"No peer reviews yet. Be the first to provide feedback!"})})]}),(0,s.jsx)("div",{className:"flex gap-2 pt-4",children:(0,s.jsx)(r.Button,{variant:"outline",onClick:()=>L(!1),className:"flex-1",children:"Close"})})]})]})}),(0,s.jsx)(k.PeerReviewDialog,{open:O,onOpenChange:z,onSubmit:$,itemType:"report",itemName:P?.eventName||""}),(0,s.jsx)(I.ResponseDialog,{open:M,onOpenChange:e=>{U(e),e||q(null)},onSubmit:G,itemType:"report"})]})})}var L=e.i(71689);function P({report:e,onBack:t,onDownload:a,getStatusColor:l}){return(0,s.jsx)("div",{className:"bg-white border-b sticky top-0 z-10",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(r.Button,{variant:"outline",onClick:t,children:[(0,s.jsx)(L.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Reports"]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.status&&(0,s.jsx)(N.Badge,{className:l(e.status),children:e.status}),(0,s.jsxs)(r.Button,{onClick:()=>a(e),children:[(0,s.jsx)(C.Download,{className:"h-4 w-4 mr-2"}),"Download Report"]})]})]})})})}function H({report:e}){return e.thumbnailUrl?(0,s.jsx)("div",{className:"rounded-xl overflow-hidden shadow-2xl mb-8",children:(0,s.jsx)("img",{src:e.thumbnailUrl,alt:e.eventName,className:"w-full h-96 object-cover"})}):null}let O=(0,j.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var z=e.i(61911);let M=(0,j.default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);function U({report:e}){return(0,s.jsxs)("header",{className:"space-y-4",children:[(0,s.jsx)("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 leading-tight",children:e.eventName}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-6 text-gray-600 border-b pb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.Calendar,{className:"h-5 w-5 text-blue-600"}),(0,s.jsx)("span",{children:new Date(e.eventDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.location&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(O,{className:"h-5 w-5 text-red-600"}),(0,s.jsx)("span",{children:e.location})]}),e.participants&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(z.Users,{className:"h-5 w-5 text-green-600"}),(0,s.jsxs)("span",{children:[e.participants," Participants"]})]}),e.duration&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(M,{className:"h-5 w-5 text-purple-600"}),(0,s.jsx)("span",{children:e.duration})]})]}),(0,s.jsx)("div",{children:(0,s.jsx)(N.Badge,{variant:"outline",className:"text-base px-4 py-2 bg-blue-50 text-blue-700 border-blue-200",children:e.community})})]})}function V({report:e}){return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("section",{className:"prose prose-lg max-w-none",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Event Overview"}),(0,s.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:e.description})]}),e.objectives&&(0,s.jsxs)("section",{className:"bg-blue-50 rounded-lg p-6 border border-blue-100",children:[(0,s.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"h-8 w-1 bg-blue-600 rounded"}),"Objectives"]}),(0,s.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:e.objectives})]}),e.outcomes&&(0,s.jsxs)("section",{className:"bg-green-50 rounded-lg p-6 border border-green-100",children:[(0,s.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,s.jsx)("div",{className:"h-8 w-1 bg-green-600 rounded"}),"Outcomes & Impact"]}),(0,s.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:e.outcomes})]})]})}function q({report:e}){return(0,s.jsx)("section",{className:"border-t pt-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,s.jsx)(T.User,{className:"h-6 w-6 text-blue-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Coordinated by"}),(0,s.jsx)("p",{className:"font-medium text-gray-900",children:e.facultyCoordinator})]})]})})}function $({report:e,getStatusColor:t,onRespondClick:a,showRespond:l}){return e.adminRemarks?(0,s.jsxs)("section",{className:"border-t pt-8 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-2",children:[(0,s.jsx)(D.MessageSquare,{className:"h-6 w-6 text-gray-600"}),"Admin Review"]}),e.status&&(0,s.jsx)(N.Badge,{className:t(e.status),children:e.status})]}),(0,s.jsx)(A.Alert,{className:"Approved"===e.status?"border-green-200 bg-green-50":"Rejected"===e.status?"border-red-200 bg-red-50":"border-blue-200 bg-blue-50",children:(0,s.jsxs)(A.AlertDescription,{children:[(0,s.jsx)("p",{className:"text-sm mb-3",children:e.adminRemarks}),e.reviewedBy&&(0,s.jsxs)("div",{className:"text-xs text-gray-600 pt-2 border-t border-gray-200",children:[(0,s.jsxs)("p",{children:["Reviewed by: ",e.reviewedBy]}),e.reviewedDate&&(0,s.jsxs)("p",{children:["Date: ",e.reviewedDate]})]})]})}),e.facultyResponse?(0,s.jsx)(A.Alert,{className:"border-blue-200 bg-blue-50",children:(0,s.jsxs)(A.AlertDescription,{children:[(0,s.jsx)("p",{className:"text-xs text-blue-800 mb-2",children:"Your Response:"}),(0,s.jsx)("p",{className:"text-sm mb-3",children:e.facultyResponse}),e.responseDate&&(0,s.jsx)("div",{className:"text-xs text-gray-600 pt-2 border-t border-gray-200",children:(0,s.jsxs)("p",{children:["Response Date: ",e.responseDate]})})]})}):l&&(0,s.jsxs)(r.Button,{variant:"outline",onClick:a,className:"w-full",children:[(0,s.jsx)(R.Reply,{className:"h-4 w-4 mr-2"}),"Respond to Admin Review"]})]}):null}let G=(0,j.default)("file-down",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);function J({report:e,onSelectImage:t}){return e.galleryImages&&0!==e.galleryImages.length?(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:"Event Gallery"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.galleryImages.map((e,a)=>(0,s.jsx)("div",{className:"relative aspect-square rounded-lg overflow-hidden cursor-pointer group shadow-md hover:shadow-xl transition-shadow",onClick:()=>t(e),children:(0,s.jsx)("img",{src:e,alt:`Gallery ${a+1}`,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})},a))})]}):null}function W({report:e,onDownload:t}){return(0,s.jsx)("section",{className:"border-t pt-6",children:(0,s.jsxs)(r.Button,{onClick:()=>t(e),className:"w-full",size:"lg",children:[(0,s.jsx)(G,{className:"h-5 w-5 mr-2"}),"Download Full Report"]})})}function Y({selectedImage:e,onClose:t}){return e?(0,s.jsxs)("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:t,children:[(0,s.jsx)("img",{src:e,alt:"Gallery",className:"max-w-full max-h-full object-contain rounded-lg"}),(0,s.jsx)(r.Button,{variant:"outline",className:"absolute top-4 right-4",onClick:t,children:"Close"})]}):null}function K({report:e,onBack:r,onDownload:l,onRespondToAdminReview:i,currentUser:n}){let[c,o]=(0,t.useState)(!1),[d,m]=(0,t.useState)(null),x=e=>{switch(e){case"Approved":return"bg-green-100 text-green-800";case"Submitted":return"bg-blue-100 text-blue-800";case"Draft":default:return"bg-gray-100 text-gray-800";case"Rejected":return"bg-red-100 text-red-800"}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(P,{report:e,onBack:r,onDownload:l,getStatusColor:x}),(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsx)(H,{report:e}),(0,s.jsx)(a.Card,{className:"shadow-lg p-0",children:(0,s.jsxs)(a.CardContent,{className:"p-8 md:p-12 space-y-8",children:[(0,s.jsx)(U,{report:e}),(0,s.jsx)(V,{report:e}),(0,s.jsx)(J,{report:e,onSelectImage:m}),(0,s.jsx)(q,{report:e}),(0,s.jsx)($,{report:e,getStatusColor:x,onRespondClick:()=>o(!0),showRespond:n===e.facultyCoordinator}),(0,s.jsx)(W,{report:e,onDownload:l})]})})]})}),(0,s.jsx)(Y,{selectedImage:d,onClose:()=>m(null)}),(0,s.jsx)(I.ResponseDialog,{open:c,onOpenChange:o,onSubmit:e=>{i(e),o(!1)},itemType:"report"})]})}var Z=e.i(32341);function _({initialReports:e=[],communities:j=[]}){let[C,S]=(0,t.useState)(e),[D,R]=(0,t.useState)(j),{user:T,userRole:A}=(0,Z.useAuth)(),k=T?.name??"",[I,B]=(0,t.useState)(""),[L,P]=(0,t.useState)("all"),[H,O]=(0,t.useState)("all"),[z,M]=(0,t.useState)(!1),[U,V]=(0,t.useState)(!1),[q,$]=(0,t.useState)(null),[G,J]=(0,t.useState)(null),[W,Y]=(0,t.useState)({eventName:"",community:"",eventDate:"",description:"",location:"",participants:"",duration:"",objectives:"",outcomes:"",thumbnailFile:null,galleryFiles:[]}),[_,Q]=(0,t.useState)([]);(0,t.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/event-reports"),s=await e.json();if(!e.ok)return void f.toast.error(s.error||"Failed to load reports");S(s.reports??[]),R(s.communities??[])}catch(e){console.error("Load reports error:",e),f.toast.error("Failed to load reports")}})()},[]);let X=async e=>{if(e.preventDefault(),!W.thumbnailFile)return void f.toast.error("Please upload a thumbnail image");try{let e=await fetch("/api/event-reports",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({facultyId:T?.id,facultyCoordinator:k,department:T?.department,eventName:W.eventName,community:W.community,eventDate:W.eventDate,description:W.description,location:W.location||void 0,participants:W.participants?parseInt(W.participants):void 0,duration:W.duration||void 0,objectives:W.objectives||void 0,outcomes:W.outcomes||void 0,thumbnailUrl:G||void 0,galleryImages:_.length>0?_:void 0,status:"Draft"})}),s=await e.json();if(!e.ok)return void f.toast.error(s.error||"Report creation failed");S(s.reports),M(!1),f.toast.success("Event report created successfully"),window.dispatchEvent(new Event("dashboard:data-updated")),Y({eventName:"",community:"",eventDate:"",description:"",location:"",participants:"",duration:"",objectives:"",outcomes:"",thumbnailFile:null,galleryFiles:[]}),J(null),Q([])}catch(e){console.error("Report create error:",e),f.toast.error("An error occurred during creation")}},ee=async e=>{try{let s=await fetch(`/api/event-reports/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"Submitted",submittedDate:new Date().toISOString().split("T")[0]})}),t=await s.json();if(!s.ok)return void f.toast.error(t.error||"Submit failed");S(t.reports),f.toast.success("Report submitted for review"),window.dispatchEvent(new Event("dashboard:data-updated"))}catch(e){console.error("Submit error:",e),f.toast.error("An error occurred while submitting")}},es=async e=>{try{let s=await fetch(`/api/event-reports/${e}`,{method:"DELETE"}),t=await s.json();if(!s.ok)return void f.toast.error(t.error||"Delete failed");S(t.reports),f.toast.success("Report deleted successfully"),window.dispatchEvent(new Event("dashboard:data-updated"))}catch(e){console.error("Delete error:",e),f.toast.error("An error occurred while deleting")}},et=(0,t.useMemo)(()=>"faculty"===A&&T?.id?C.filter(e=>e.facultyId===T.id):C,[C,T?.id,A]),ea=et.filter(e=>{let s=e.eventName.toLowerCase().includes(I.toLowerCase())||e.community.toLowerCase().includes(I.toLowerCase()),t="all"===H||e.status===H,a="all"===L||e.community===L;return s&&t&&a});return U&&q?(0,s.jsx)(K,{report:q,onBack:()=>V(!1),onDownload:e=>{let s=(0,F.sanitizeFileName)(e.eventName,"event-report"),t=`${s||"event-report"}.json`;(0,F.downloadJsonFile)(e,t),f.toast.success(`Downloading ${e.eventName} report`)},onRespondToAdminReview:async e=>{try{let s=await fetch(`/api/event-reports/${q.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({facultyResponse:e})}),t=await s.json();if(!s.ok)return void f.toast.error(t.error||"Response failed");S(t.reports);let a=t.reports.find(e=>e.id===q.id);a&&$(a),f.toast.success("Response submitted successfully"),window.dispatchEvent(new Event("dashboard:data-updated"))}catch(e){console.error("Response error:",e),f.toast.error("An error occurred while responding")}},currentUser:k}):(0,s.jsxs)(a.Card,{children:[(0,s.jsxs)(a.CardHeader,{children:[(0,s.jsx)(a.CardTitle,{children:"Community Event Reports"}),(0,s.jsx)(a.CardDescription,{children:"Create and manage reports for community engagement and outreach events"})]}),(0,s.jsx)(a.CardContent,{className:"space-y-4",children:(0,s.jsxs)(w.Tabs,{defaultValue:"my-reports",className:"w-full",children:[(0,s.jsxs)(w.TabsList,{className:"grid w-full grid-cols-2",children:[(0,s.jsx)(w.TabsTrigger,{value:"my-reports",children:"My Reports"}),(0,s.jsx)(w.TabsTrigger,{value:"all-reports",children:"All Faculty Reports"})]}),(0,s.jsxs)(w.TabsContent,{value:"my-reports",className:"space-y-4 mt-4",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(p.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)(l.Input,{placeholder:"Search reports...",value:I,onChange:e=>B(e.target.value),className:"pl-10"})]}),(0,s.jsxs)(c.Select,{value:H,onValueChange:O,children:[(0,s.jsx)(c.SelectTrigger,{className:"w-full md:w-40",children:(0,s.jsx)(c.SelectValue,{placeholder:"Filter by Status"})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"All Status"}),(0,s.jsx)(c.SelectItem,{value:"Draft",children:"Draft"}),(0,s.jsx)(c.SelectItem,{value:"Submitted",children:"Submitted"}),(0,s.jsx)(c.SelectItem,{value:"Approved",children:"Approved"}),(0,s.jsx)(c.SelectItem,{value:"Rejected",children:"Rejected"})]})]}),(0,s.jsxs)(c.Select,{value:L,onValueChange:P,children:[(0,s.jsx)(c.SelectTrigger,{className:"w-full md:w-48",children:(0,s.jsx)(c.SelectValue,{placeholder:"Filter by Community"})}),(0,s.jsxs)(c.SelectContent,{children:[(0,s.jsx)(c.SelectItem,{value:"all",children:"All Communities"}),D.map(e=>(0,s.jsx)(c.SelectItem,{value:e,children:e},e))]})]}),(0,s.jsxs)(d.Dialog,{open:z,onOpenChange:M,children:[(0,s.jsx)(d.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(r.Button,{className:"w-full md:w-auto",children:[(0,s.jsx)(u.Plus,{className:"h-4 w-4 mr-2"}),"Create Report"]})}),(0,s.jsxs)(d.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(d.DialogHeader,{children:[(0,s.jsx)(d.DialogTitle,{children:"Create Event Report"}),(0,s.jsx)(d.DialogDescription,{children:"Document a community engagement event with details and thumbnail"})]}),(0,s.jsxs)("form",{onSubmit:X,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"thumbnail",children:"Event Thumbnail *"}),(0,s.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-gray-400 transition-colors",children:G?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:G,alt:"Thumbnail preview",className:"w-full h-64 object-cover rounded-lg"}),(0,s.jsx)(r.Button,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{Y({...W,thumbnailFile:null}),J(null)},children:(0,s.jsx)(y.default,{className:"h-4 w-4"})})]}):(0,s.jsxs)("label",{htmlFor:"thumbnail",className:"flex flex-col items-center cursor-pointer",children:[(0,s.jsx)(b,{className:"h-12 w-12 text-gray-400 mb-2"}),(0,s.jsx)("span",{className:"text-sm text-gray-600 mb-1",children:"Click to upload thumbnail image"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"PNG, JPG up to 5MB"}),(0,s.jsx)(l.Input,{id:"thumbnail",type:"file",accept:"image/*",onChange:e=>{let s=e.target.files?.[0];if(s){if(s.size>5242880)return void f.toast.error("Thumbnail size should be less than 5MB");if(!s.type.startsWith("image/"))return void f.toast.error("Please upload an image file");Y({...W,thumbnailFile:s});let e=new FileReader;e.onloadend=()=>{J(e.result)},e.readAsDataURL(s)}},className:"hidden"})]})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"eventName",children:"Event Name *"}),(0,s.jsx)(l.Input,{id:"eventName",value:W.eventName,onChange:e=>Y({...W,eventName:e.target.value}),placeholder:"e.g., Community Health Workshop",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"community",children:"Community *"}),(0,s.jsxs)(c.Select,{value:W.community,onValueChange:e=>Y({...W,community:e}),children:[(0,s.jsx)(c.SelectTrigger,{id:"community",children:(0,s.jsx)(c.SelectValue,{placeholder:"Select community type"})}),(0,s.jsx)(c.SelectContent,{children:D.map(e=>(0,s.jsx)(c.SelectItem,{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"eventDate",children:"Event Date *"}),(0,s.jsx)(l.Input,{id:"eventDate",type:"date",value:W.eventDate,onChange:e=>Y({...W,eventDate:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"location",children:"Location"}),(0,s.jsx)(l.Input,{id:"location",value:W.location,onChange:e=>Y({...W,location:e.target.value}),placeholder:"e.g., Community Center"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"participants",children:"Number of Participants"}),(0,s.jsx)(l.Input,{id:"participants",type:"number",min:"0",value:W.participants,onChange:e=>Y({...W,participants:e.target.value}),placeholder:"0"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"duration",children:"Duration"}),(0,s.jsx)(l.Input,{id:"duration",value:W.duration,onChange:e=>Y({...W,duration:e.target.value}),placeholder:"e.g., 3 hours"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"description",children:"Event Description *"}),(0,s.jsx)(n.Textarea,{id:"description",value:W.description,onChange:e=>Y({...W,description:e.target.value}),placeholder:"Provide a detailed description of the event, its activities, and impact...",rows:4,required:!0}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Provide comprehensive details about the event, activities conducted, and community impact."})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"objectives",children:"Objectives"}),(0,s.jsx)(n.Textarea,{id:"objectives",value:W.objectives,onChange:e=>Y({...W,objectives:e.target.value}),placeholder:"What were the goals and objectives of this event?",rows:3})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"outcomes",children:"Outcomes & Impact"}),(0,s.jsx)(n.Textarea,{id:"outcomes",value:W.outcomes,onChange:e=>Y({...W,outcomes:e.target.value}),placeholder:"What were the results and impact of the event?",rows:3})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i.Label,{htmlFor:"gallery",children:"Gallery Images (optional)"}),(0,s.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-gray-400 transition-colors",children:_.length>0?(0,s.jsx)("div",{className:"grid grid-cols-3 gap-4",children:_.map((e,t)=>(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:e,alt:`Gallery preview ${t+1}`,className:"w-full h-24 object-cover rounded-lg"}),(0,s.jsx)(r.Button,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{let e,s;return e=W.galleryFiles.filter((e,s)=>s!==t),s=_.filter((e,s)=>s!==t),void(Y({...W,galleryFiles:e}),Q(s))},children:(0,s.jsx)(y.default,{className:"h-4 w-4"})})]},t))}):(0,s.jsxs)("label",{htmlFor:"gallery",className:"flex flex-col items-center cursor-pointer",children:[(0,s.jsx)(b,{className:"h-12 w-12 text-gray-400 mb-2"}),(0,s.jsx)("span",{className:"text-sm text-gray-600 mb-1",children:"Click to upload gallery images"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"PNG, JPG up to 5MB each"}),(0,s.jsx)(l.Input,{id:"gallery",type:"file",accept:"image/*",multiple:!0,onChange:e=>{let s=Array.from(e.target.files||[]);if(s.length+W.galleryFiles.length>10)return void f.toast.error("Maximum 10 gallery images allowed");let t=[],a=[];s.forEach(e=>{if(e.size>5242880)return void f.toast.error(`${e.name} is too large. Max size is 5MB`);if(!e.type.startsWith("image/"))return void f.toast.error(`${e.name} is not an image file`);t.push(e);let s=new FileReader;s.onloadend=()=>{a.push(s.result),a.length===t.length&&Q([..._,...a])},s.readAsDataURL(e)}),Y({...W,galleryFiles:[...W.galleryFiles,...t]})},className:"hidden"})]})})]}),(0,s.jsx)("div",{className:"flex gap-2 pt-4",children:(0,s.jsxs)(r.Button,{type:"submit",className:"flex-1",children:[(0,s.jsx)(g.Upload,{className:"h-4 w-4 mr-2"}),"Save as Draft"]})})]})]})]})]}),(0,s.jsx)("div",{className:"border rounded-lg",children:(0,s.jsxs)(o.Table,{children:[(0,s.jsx)(o.TableHeader,{children:(0,s.jsxs)(o.TableRow,{children:[(0,s.jsx)(o.TableHead,{children:"Event"}),(0,s.jsx)(o.TableHead,{children:"Community"}),(0,s.jsx)(o.TableHead,{children:"Date"}),(0,s.jsx)(o.TableHead,{children:"Status"}),(0,s.jsx)(o.TableHead,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(o.TableBody,{children:0===ea.length?(0,s.jsx)(o.TableRow,{children:(0,s.jsx)(o.TableCell,{colSpan:5,className:"text-center text-gray-500 py-8",children:"No reports found. Create your first event report to get started."})}):ea.map(e=>(0,s.jsxs)(o.TableRow,{children:[(0,s.jsx)(o.TableCell,{children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[e.thumbnailUrl&&(0,s.jsx)("img",{src:e.thumbnailUrl,alt:e.eventName,className:"h-12 w-12 rounded object-cover"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.eventName}),e.location&&(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.location})]})]})}),(0,s.jsx)(o.TableCell,{children:(0,s.jsx)(N.Badge,{variant:"outline",children:e.community})}),(0,s.jsx)(o.TableCell,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.Calendar,{className:"h-4 w-4 text-gray-400"}),new Date(e.eventDate).toLocaleDateString()]})}),(0,s.jsx)(o.TableCell,{children:(0,s.jsx)(N.Badge,{className:(e=>{switch(e){case"Approved":return"bg-green-100 text-green-800";case"Submitted":return"bg-blue-100 text-blue-800";case"Draft":default:return"bg-gray-100 text-gray-800";case"Rejected":return"bg-red-100 text-red-800"}})(e.status),children:e.status})}),(0,s.jsx)(o.TableCell,{children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>{$(e),V(!0)},children:(0,s.jsx)(x.Eye,{className:"h-4 w-4"})}),"Draft"===e.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>ee(e.id),children:(0,s.jsx)(v,{className:"h-4 w-4 text-green-600"})}),(0,s.jsx)(r.Button,{variant:"ghost",size:"sm",onClick:()=>es(e.id),children:(0,s.jsx)(h.Trash2,{className:"h-4 w-4 text-red-600"})})]})]})})]},e.id))})]})})]}),(0,s.jsx)(w.TabsContent,{value:"all-reports",className:"space-y-4 mt-4",children:(0,s.jsx)(E,{reports:et,currentUser:k,onReportsChange:S})})]})})]})}e.s(["EventReportManager",()=>_],16721)}]);