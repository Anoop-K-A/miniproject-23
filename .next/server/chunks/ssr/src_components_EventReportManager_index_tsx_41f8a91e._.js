module.exports=[14226,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(91119),e=a.i(99570),f=a.i(66718),g=a.i(70430),h=a.i(29246),i=a.i(80701),j=a.i(6015),k=a.i(14574),l=a.i(41675),m=a.i(77156),n=a.i(81560),o=a.i(15618),p=a.i(87532),q=a.i(70106);let r=(0,q.default)("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);var s=a.i(73320);let t=(0,q.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var u=a.i(62213),u=u,v=a.i(86304),w=a.i(23292),x=a.i(75083),y=a.i(84505),z=a.i(69012),A=a.i(63588),B=a.i(23808),C=a.i(46842),D=a.i(24348),E=a.i(47219),F=a.i(33483),G=a.i(76841),H=a.i(21562);function I({reports:a,currentUser:g,onReportsChange:h}){let[n,o]=(0,c.useState)(""),[q,r]=(0,c.useState)("all"),[s,t]=(0,c.useState)("all"),[u,x]=(0,c.useState)("all"),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(null),S=async a=>{if(!K)return;let b={id:`pr${Date.now()}`,reviewerName:g,reviewDate:new Date().toISOString().split("T")[0],comment:a},c={...K,peerReviews:[...K.peerReviews||[],b]};try{let a=await fetch(`/api/event-reports/${K.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({peerReviews:c.peerReviews})}),b=await a.json();if(!a.ok)return void w.toast.error(b.error||"Peer review failed");h?.(b.reports);let d=b.reports.find(a=>a.id===K.id);L(d??c),N(!1)}catch(a){console.error("Peer review error:",a),w.toast.error("An error occurred while submitting review")}},T=async a=>{if(!K||!Q)return;let b={...K,peerReviews:K.peerReviews?.map(b=>b.id===Q.id?{...b,facultyResponse:a,responseDate:new Date().toISOString().split("T")[0]}:b)};try{let a=await fetch(`/api/event-reports/${K.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({peerReviews:b.peerReviews})}),c=await a.json();if(!a.ok)return void w.toast.error(c.error||"Response failed");h?.(c.reports);let d=c.reports.find(a=>a.id===K.id);L(d??b),R(null),P(!1)}catch(a){console.error("Response error:",a),w.toast.error("An error occurred while responding")}},U=a=>{switch(a){case"Approved":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";case"Submitted":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},V=a.filter(a=>{let b=a.eventName.toLowerCase().includes(n.toLowerCase())||a.facultyCoordinator.toLowerCase().includes(n.toLowerCase())||a.eventType&&a.eventType.toLowerCase().includes(n.toLowerCase()),c="all"===q||a.department===q,d="all"===s||a.status===s,e="all"===u||new Date(a.eventDate).getFullYear().toString()===u;return b&&c&&d&&e}),W=Array.from(new Set(a.map(a=>a.department).filter(Boolean))),X=Array.from(new Set(a.map(a=>new Date(a.eventDate).getFullYear().toString()))).sort((a,b)=>parseInt(b)-parseInt(a));return(0,b.jsx)(d.Card,{children:(0,b.jsxs)(d.CardContent,{className:"pt-6 space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)(p.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)(f.Input,{placeholder:"Search by event name, faculty, or type...",value:n,onChange:a=>o(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(i.Select,{value:q,onValueChange:r,children:[(0,b.jsxs)(i.SelectTrigger,{className:"w-full md:w-48",children:[(0,b.jsx)(z.Filter,{className:"h-4 w-4 mr-2"}),(0,b.jsx)(i.SelectValue,{placeholder:"Department"})]}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Departments"}),W.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:a},a))]})]}),(0,b.jsxs)(i.Select,{value:s,onValueChange:t,children:[(0,b.jsxs)(i.SelectTrigger,{className:"w-full md:w-48",children:[(0,b.jsx)(z.Filter,{className:"h-4 w-4 mr-2"}),(0,b.jsx)(i.SelectValue,{placeholder:"Status"})]}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(i.SelectItem,{value:"Approved",children:"Approved"}),(0,b.jsx)(i.SelectItem,{value:"Submitted",children:"Submitted"}),(0,b.jsx)(i.SelectItem,{value:"Rejected",children:"Rejected"}),(0,b.jsx)(i.SelectItem,{value:"Draft",children:"Draft"})]})]}),(0,b.jsxs)(i.Select,{value:u,onValueChange:x,children:[(0,b.jsxs)(i.SelectTrigger,{className:"w-full md:w-48",children:[(0,b.jsx)(z.Filter,{className:"h-4 w-4 mr-2"}),(0,b.jsx)(i.SelectValue,{placeholder:"Year"})]}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Years"}),X.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:a},a))]})]})]}),(0,b.jsx)("div",{className:"border rounded-lg",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Event Name"}),(0,b.jsx)(j.TableHead,{children:"Coordinator"}),(0,b.jsx)(j.TableHead,{children:"Event Date"}),(0,b.jsx)(j.TableHead,{children:"Type"}),(0,b.jsx)(j.TableHead,{children:"Status"}),(0,b.jsx)(j.TableHead,{children:"Peer Reviews"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(j.TableBody,{children:0===V.length?(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:7,className:"text-center text-gray-500 py-8",children:"No event reports found matching your criteria."})}):V.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Calendar,{className:"h-4 w-4 text-purple-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:a.eventName}),a.location&&(0,b.jsx)("div",{className:"text-sm text-gray-500",children:a.location})]})]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:a.facultyCoordinator}),a.department&&(0,b.jsx)("div",{className:"text-sm text-gray-500",children:a.department})]})}),(0,b.jsx)(j.TableCell,{children:a.eventDate}),(0,b.jsx)(j.TableCell,{children:a.eventType&&(0,b.jsx)(v.Badge,{variant:"secondary",children:a.eventType})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(v.Badge,{className:U(a.status),children:a.status})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(A.MessageSquare,{className:"h-4 w-4 text-gray-400"}),(0,b.jsx)("span",{className:"text-sm",children:a.peerReviews?.length||0})]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{L(a),J(!0)},children:(0,b.jsx)(m.Eye,{className:"h-4 w-4 text-blue-600"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{let b,c;return b=(0,H.sanitizeFileName)(a.eventName,"event-report"),c=`${b||"event-report"}.json`,void((0,H.downloadJsonFile)(a,c),w.toast.success(`Downloading ${a.eventName} report`))},children:(0,b.jsx)(y.Download,{className:"h-4 w-4"})})]})})]},a.id))})]})}),(0,b.jsx)(k.Dialog,{open:I,onOpenChange:J,children:(0,b.jsxs)(k.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Event Report Details & Peer Review"}),(0,b.jsx)(k.DialogDescription,{children:K&&(0,b.jsxs)("span",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)(l.Calendar,{className:"h-4 w-4"}),K.eventName]})})]}),K&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Coordinator"}),(0,b.jsx)("p",{children:K.facultyCoordinator})]}),K.department&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Department"}),(0,b.jsx)("p",{children:K.department})]}),K.eventType&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Event Type"}),(0,b.jsx)("p",{children:K.eventType})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Event Date"}),(0,b.jsx)("p",{children:K.eventDate})]}),K.location&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Location"}),(0,b.jsx)("p",{children:K.location})]}),K.participants&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Participants"}),(0,b.jsx)("p",{children:K.participants})]}),K.duration&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Duration"}),(0,b.jsx)("p",{children:K.duration})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,b.jsx)(v.Badge,{className:U(K.status),children:K.status})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[K.description&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Description"}),(0,b.jsx)("p",{className:"text-sm",children:K.description})]}),K.objectives&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Objectives"}),(0,b.jsx)("p",{className:"text-sm",children:K.objectives})]}),K.outcomes&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-1",children:"Outcomes"}),(0,b.jsx)("p",{className:"text-sm",children:K.outcomes})]})]}),K.adminRemarks&&(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsxs)("h4",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)(A.MessageSquare,{className:"h-5 w-5 text-gray-600"}),"Admin Review"]}),(0,b.jsx)(D.Alert,{className:"Approved"===K.status?"border-green-200 bg-green-50":"Rejected"===K.status?"border-red-200 bg-red-50":"border-blue-200 bg-blue-50",children:(0,b.jsxs)(D.AlertDescription,{children:[(0,b.jsx)("p",{className:"text-sm mb-3",children:K.adminRemarks}),K.reviewedBy&&(0,b.jsxs)("div",{className:"text-xs text-gray-600 pt-2 border-t border-gray-200",children:[(0,b.jsxs)("p",{children:["Reviewed by: ",K.reviewedBy]}),K.reviewedDate&&(0,b.jsxs)("p",{children:["Date: ",K.reviewedDate]})]})]})})]}),(0,b.jsxs)("div",{className:"border-t pt-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("h4",{className:"flex items-center gap-2",children:[(0,b.jsx)(A.MessageSquare,{className:"h-5 w-5 text-gray-600"}),"Peer Reviews (",K.peerReviews?.length||0,")"]}),(0,b.jsxs)(e.Button,{size:"sm",onClick:()=>N(!0),children:[(0,b.jsx)(A.MessageSquare,{className:"h-4 w-4 mr-2"}),"Add Review"]})]}),K.peerReviews&&K.peerReviews.length>0?(0,b.jsx)(G.Accordion,{type:"single",collapsible:!0,className:"w-full border rounded-lg",children:K.peerReviews.map(a=>(0,b.jsxs)(G.AccordionItem,{value:a.id,children:[(0,b.jsx)(G.AccordionTrigger,{className:"px-4 hover:no-underline",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full pr-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-8 w-8 rounded-full bg-purple-100 flex items-center justify-center",children:(0,b.jsx)(C.User,{className:"h-4 w-4 text-purple-600"})}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("p",{className:"font-medium",children:a.reviewerName}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:a.reviewDate})]})]}),a.facultyResponse&&(0,b.jsx)(v.Badge,{className:"bg-blue-100 text-blue-800 mr-2",children:"Responded"})]})}),(0,b.jsx)(G.AccordionContent,{className:"px-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(D.Alert,{className:"border-purple-200 bg-purple-50",children:(0,b.jsxs)(D.AlertDescription,{children:[(0,b.jsx)("p",{className:"text-xs text-purple-800 mb-2",children:"Review:"}),(0,b.jsx)("p",{className:"text-sm",children:a.comment})]})}),a.facultyResponse?(0,b.jsx)(D.Alert,{className:"border-blue-200 bg-blue-50",children:(0,b.jsxs)(D.AlertDescription,{children:[(0,b.jsxs)("p",{className:"text-xs text-blue-800 mb-2",children:["Response from"," ",K.facultyCoordinator,":"]}),(0,b.jsx)("p",{className:"text-sm",children:a.facultyResponse}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:a.responseDate})]})}):(0,b.jsx)("div",{className:"space-y-2",children:a.reviewerName===CURRENT_USER?(0,b.jsx)(D.Alert,{children:(0,b.jsxs)(D.AlertDescription,{className:"text-xs text-gray-500 italic",children:["Awaiting response from"," ",K.facultyCoordinator,"..."]})}):K.facultyCoordinator===CURRENT_USER?(0,b.jsxs)(e.Button,{variant:"outline",size:"sm",onClick:()=>{R(a),P(!0)},className:"w-full",children:[(0,b.jsx)(B.Reply,{className:"h-4 w-4 mr-2"}),"Respond to Review"]}):null})]})})]},a.id))}):(0,b.jsx)(D.Alert,{children:(0,b.jsx)(D.AlertDescription,{className:"text-sm text-gray-500",children:"No peer reviews yet. Be the first to provide feedback!"})})]}),(0,b.jsx)("div",{className:"flex gap-2 pt-4",children:(0,b.jsx)(e.Button,{variant:"outline",onClick:()=>J(!1),className:"flex-1",children:"Close"})})]})]})}),(0,b.jsx)(E.PeerReviewDialog,{open:M,onOpenChange:N,onSubmit:S,itemType:"report",itemName:K?.eventName||""}),(0,b.jsx)(F.ResponseDialog,{open:O,onOpenChange:a=>{P(a),a||R(null)},onSubmit:T,itemType:"report"})]})})}var J=a.i(210);function K({report:a,onBack:c,onDownload:d,getStatusColor:f}){return(0,b.jsx)("div",{className:"bg-white border-b sticky top-0 z-10",children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(e.Button,{variant:"outline",onClick:c,children:[(0,b.jsx)(J.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back to Reports"]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[a.status&&(0,b.jsx)(v.Badge,{className:f(a.status),children:a.status}),(0,b.jsxs)(e.Button,{onClick:()=>d(a),children:[(0,b.jsx)(y.Download,{className:"h-4 w-4 mr-2"}),"Download Report"]})]})]})})})}function L({report:a}){return a.thumbnailUrl?(0,b.jsx)("div",{className:"rounded-xl overflow-hidden shadow-2xl mb-8",children:(0,b.jsx)("img",{src:a.thumbnailUrl,alt:a.eventName,className:"w-full h-96 object-cover"})}):null}let M=(0,q.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var N=a.i(60246);let O=(0,q.default)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);function P({report:a}){return(0,b.jsxs)("header",{className:"space-y-4",children:[(0,b.jsx)("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 leading-tight",children:a.eventName}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-6 text-gray-600 border-b pb-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Calendar,{className:"h-5 w-5 text-blue-600"}),(0,b.jsx)("span",{children:new Date(a.eventDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),a.location&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(M,{className:"h-5 w-5 text-red-600"}),(0,b.jsx)("span",{children:a.location})]}),a.participants&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(N.Users,{className:"h-5 w-5 text-green-600"}),(0,b.jsxs)("span",{children:[a.participants," Participants"]})]}),a.duration&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(O,{className:"h-5 w-5 text-purple-600"}),(0,b.jsx)("span",{children:a.duration})]})]}),(0,b.jsx)("div",{children:(0,b.jsx)(v.Badge,{variant:"outline",className:"text-base px-4 py-2 bg-blue-50 text-blue-700 border-blue-200",children:a.community})})]})}function Q({report:a}){return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("section",{className:"prose prose-lg max-w-none",children:[(0,b.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Event Overview"}),(0,b.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:a.description})]}),a.objectives&&(0,b.jsxs)("section",{className:"bg-blue-50 rounded-lg p-6 border border-blue-100",children:[(0,b.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-8 w-1 bg-blue-600 rounded"}),"Objectives"]}),(0,b.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:a.objectives})]}),a.outcomes&&(0,b.jsxs)("section",{className:"bg-green-50 rounded-lg p-6 border border-green-100",children:[(0,b.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-8 w-1 bg-green-600 rounded"}),"Outcomes & Impact"]}),(0,b.jsx)("p",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:a.outcomes})]})]})}function R({report:a}){return(0,b.jsx)("section",{className:"border-t pt-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,b.jsx)(C.User,{className:"h-6 w-6 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Coordinated by"}),(0,b.jsx)("p",{className:"font-medium text-gray-900",children:a.facultyCoordinator})]})]})})}function S({report:a,getStatusColor:c,onRespondClick:d,showRespond:f}){return a.adminRemarks?(0,b.jsxs)("section",{className:"border-t pt-8 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-2",children:[(0,b.jsx)(A.MessageSquare,{className:"h-6 w-6 text-gray-600"}),"Admin Review"]}),a.status&&(0,b.jsx)(v.Badge,{className:c(a.status),children:a.status})]}),(0,b.jsx)(D.Alert,{className:"Approved"===a.status?"border-green-200 bg-green-50":"Rejected"===a.status?"border-red-200 bg-red-50":"border-blue-200 bg-blue-50",children:(0,b.jsxs)(D.AlertDescription,{children:[(0,b.jsx)("p",{className:"text-sm mb-3",children:a.adminRemarks}),a.reviewedBy&&(0,b.jsxs)("div",{className:"text-xs text-gray-600 pt-2 border-t border-gray-200",children:[(0,b.jsxs)("p",{children:["Reviewed by: ",a.reviewedBy]}),a.reviewedDate&&(0,b.jsxs)("p",{children:["Date: ",a.reviewedDate]})]})]})}),a.facultyResponse?(0,b.jsx)(D.Alert,{className:"border-blue-200 bg-blue-50",children:(0,b.jsxs)(D.AlertDescription,{children:[(0,b.jsx)("p",{className:"text-xs text-blue-800 mb-2",children:"Your Response:"}),(0,b.jsx)("p",{className:"text-sm mb-3",children:a.facultyResponse}),a.responseDate&&(0,b.jsx)("div",{className:"text-xs text-gray-600 pt-2 border-t border-gray-200",children:(0,b.jsxs)("p",{children:["Response Date: ",a.responseDate]})})]})}):f&&(0,b.jsxs)(e.Button,{variant:"outline",onClick:d,className:"w-full",children:[(0,b.jsx)(B.Reply,{className:"h-4 w-4 mr-2"}),"Respond to Admin Review"]})]}):null}let T=(0,q.default)("file-down",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);function U({report:a,onSelectImage:c}){return a.galleryImages&&0!==a.galleryImages.length?(0,b.jsxs)("section",{className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:"Event Gallery"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.galleryImages.map((a,d)=>(0,b.jsx)("div",{className:"relative aspect-square rounded-lg overflow-hidden cursor-pointer group shadow-md hover:shadow-xl transition-shadow",onClick:()=>c(a),children:(0,b.jsx)("img",{src:a,alt:`Gallery ${d+1}`,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})},d))})]}):null}function V({report:a,onDownload:c}){return(0,b.jsx)("section",{className:"border-t pt-6",children:(0,b.jsxs)(e.Button,{onClick:()=>c(a),className:"w-full",size:"lg",children:[(0,b.jsx)(T,{className:"h-5 w-5 mr-2"}),"Download Full Report"]})})}function W({selectedImage:a,onClose:c}){return a?(0,b.jsxs)("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:c,children:[(0,b.jsx)("img",{src:a,alt:"Gallery",className:"max-w-full max-h-full object-contain rounded-lg"}),(0,b.jsx)(e.Button,{variant:"outline",className:"absolute top-4 right-4",onClick:c,children:"Close"})]}):null}function X({report:a,onBack:e,onDownload:f,onRespondToAdminReview:g,currentUser:h}){let[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),m=a=>{switch(a){case"Approved":return"bg-green-100 text-green-800";case"Submitted":return"bg-blue-100 text-blue-800";case"Draft":default:return"bg-gray-100 text-gray-800";case"Rejected":return"bg-red-100 text-red-800"}};return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)(K,{report:a,onBack:e,onDownload:f,getStatusColor:m}),(0,b.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)(L,{report:a}),(0,b.jsx)(d.Card,{className:"shadow-lg p-0",children:(0,b.jsxs)(d.CardContent,{className:"p-8 md:p-12 space-y-8",children:[(0,b.jsx)(P,{report:a}),(0,b.jsx)(Q,{report:a}),(0,b.jsx)(U,{report:a,onSelectImage:l}),(0,b.jsx)(R,{report:a}),(0,b.jsx)(S,{report:a,getStatusColor:m,onRespondClick:()=>j(!0),showRespond:h===a.facultyCoordinator}),(0,b.jsx)(V,{report:a,onDownload:f})]})})]})}),(0,b.jsx)(W,{selectedImage:k,onClose:()=>l(null)}),(0,b.jsx)(F.ResponseDialog,{open:i,onOpenChange:j,onSubmit:a=>{g(a),j(!1)},itemType:"report"})]})}var Y=a.i(56025);function Z({initialReports:a=[],communities:q=[]}){let[y,z]=(0,c.useState)(a),[A,B]=(0,c.useState)(q),{user:C,userRole:D}=(0,Y.useAuth)(),E=C?.name??"",[F,G]=(0,c.useState)(""),[J,K]=(0,c.useState)("all"),[L,M]=(0,c.useState)("all"),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(null),[T,U]=(0,c.useState)(null),[V,W]=(0,c.useState)({eventName:"",community:"",eventDate:"",description:"",location:"",participants:"",duration:"",objectives:"",outcomes:"",thumbnailFile:null,galleryFiles:[]}),[Z,$]=(0,c.useState)([]);(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/event-reports"),b=await a.json();if(!a.ok)return void w.toast.error(b.error||"Failed to load reports");z(b.reports??[]),B(b.communities??[])}catch(a){console.error("Load reports error:",a),w.toast.error("Failed to load reports")}})()},[]);let _=async a=>{if(a.preventDefault(),!V.thumbnailFile)return void w.toast.error("Please upload a thumbnail image");try{let a=await fetch("/api/event-reports",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({facultyId:C?.id,facultyCoordinator:E,department:C?.department,eventName:V.eventName,community:V.community,eventDate:V.eventDate,description:V.description,location:V.location||void 0,participants:V.participants?parseInt(V.participants):void 0,duration:V.duration||void 0,objectives:V.objectives||void 0,outcomes:V.outcomes||void 0,thumbnailUrl:T||void 0,galleryImages:Z.length>0?Z:void 0,status:"Draft"})}),b=await a.json();if(!a.ok)return void w.toast.error(b.error||"Report creation failed");z(b.reports),O(!1),w.toast.success("Event report created successfully"),W({eventName:"",community:"",eventDate:"",description:"",location:"",participants:"",duration:"",objectives:"",outcomes:"",thumbnailFile:null,galleryFiles:[]}),U(null),$([])}catch(a){console.error("Report create error:",a),w.toast.error("An error occurred during creation")}},aa=async a=>{try{let b=await fetch(`/api/event-reports/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"Submitted",submittedDate:new Date().toISOString().split("T")[0]})}),c=await b.json();if(!b.ok)return void w.toast.error(c.error||"Submit failed");z(c.reports),w.toast.success("Report submitted for review")}catch(a){console.error("Submit error:",a),w.toast.error("An error occurred while submitting")}},ab=async a=>{try{let b=await fetch(`/api/event-reports/${a}`,{method:"DELETE"}),c=await b.json();if(!b.ok)return void w.toast.error(c.error||"Delete failed");z(c.reports),w.toast.success("Report deleted successfully")}catch(a){console.error("Delete error:",a),w.toast.error("An error occurred while deleting")}},ac=(0,c.useMemo)(()=>"faculty"===D&&C?.id?y.filter(a=>a.facultyId===C.id):y,[y,C?.id,D]),ad=ac.filter(a=>{let b=a.eventName.toLowerCase().includes(F.toLowerCase())||a.community.toLowerCase().includes(F.toLowerCase()),c="all"===L||a.status===L,d="all"===J||a.community===J;return b&&c&&d});return P&&R?(0,b.jsx)(X,{report:R,onBack:()=>Q(!1),onDownload:a=>{let b=(0,H.sanitizeFileName)(a.eventName,"event-report"),c=`${b||"event-report"}.json`;(0,H.downloadJsonFile)(a,c),w.toast.success(`Downloading ${a.eventName} report`)},onRespondToAdminReview:async a=>{try{let b=await fetch(`/api/event-reports/${R.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({facultyResponse:a})}),c=await b.json();if(!b.ok)return void w.toast.error(c.error||"Response failed");z(c.reports);let d=c.reports.find(a=>a.id===R.id);d&&S(d),w.toast.success("Response submitted successfully")}catch(a){console.error("Response error:",a),w.toast.error("An error occurred while responding")}},currentUser:E}):(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{children:[(0,b.jsx)(d.CardTitle,{children:"Community Event Reports"}),(0,b.jsx)(d.CardDescription,{children:"Create and manage reports for community engagement and outreach events"})]}),(0,b.jsx)(d.CardContent,{className:"space-y-4",children:(0,b.jsxs)(x.Tabs,{defaultValue:"my-reports",className:"w-full",children:[(0,b.jsxs)(x.TabsList,{className:"grid w-full grid-cols-2",children:[(0,b.jsx)(x.TabsTrigger,{value:"my-reports",children:"My Reports"}),(0,b.jsx)(x.TabsTrigger,{value:"all-reports",children:"All Faculty Reports"})]}),(0,b.jsxs)(x.TabsContent,{value:"my-reports",className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)(p.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)(f.Input,{placeholder:"Search reports...",value:F,onChange:a=>G(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(i.Select,{value:L,onValueChange:M,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-full md:w-40",children:(0,b.jsx)(i.SelectValue,{placeholder:"Filter by Status"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(i.SelectItem,{value:"Draft",children:"Draft"}),(0,b.jsx)(i.SelectItem,{value:"Submitted",children:"Submitted"}),(0,b.jsx)(i.SelectItem,{value:"Approved",children:"Approved"}),(0,b.jsx)(i.SelectItem,{value:"Rejected",children:"Rejected"})]})]}),(0,b.jsxs)(i.Select,{value:J,onValueChange:K,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-full md:w-48",children:(0,b.jsx)(i.SelectValue,{placeholder:"Filter by Community"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Communities"}),A.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:a},a))]})]}),(0,b.jsxs)(k.Dialog,{open:N,onOpenChange:O,children:[(0,b.jsx)(k.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{className:"w-full md:w-auto",children:[(0,b.jsx)(o.Plus,{className:"h-4 w-4 mr-2"}),"Create Report"]})}),(0,b.jsxs)(k.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(k.DialogHeader,{children:[(0,b.jsx)(k.DialogTitle,{children:"Create Event Report"}),(0,b.jsx)(k.DialogDescription,{children:"Document a community engagement event with details and thumbnail"})]}),(0,b.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"thumbnail",children:"Event Thumbnail *"}),(0,b.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-gray-400 transition-colors",children:T?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:T,alt:"Thumbnail preview",className:"w-full h-64 object-cover rounded-lg"}),(0,b.jsx)(e.Button,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{W({...V,thumbnailFile:null}),U(null)},children:(0,b.jsx)(u.default,{className:"h-4 w-4"})})]}):(0,b.jsxs)("label",{htmlFor:"thumbnail",className:"flex flex-col items-center cursor-pointer",children:[(0,b.jsx)(t,{className:"h-12 w-12 text-gray-400 mb-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-600 mb-1",children:"Click to upload thumbnail image"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"PNG, JPG up to 5MB"}),(0,b.jsx)(f.Input,{id:"thumbnail",type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(b){if(b.size>5242880)return void w.toast.error("Thumbnail size should be less than 5MB");if(!b.type.startsWith("image/"))return void w.toast.error("Please upload an image file");W({...V,thumbnailFile:b});let a=new FileReader;a.onloadend=()=>{U(a.result)},a.readAsDataURL(b)}},className:"hidden"})]})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"eventName",children:"Event Name *"}),(0,b.jsx)(f.Input,{id:"eventName",value:V.eventName,onChange:a=>W({...V,eventName:a.target.value}),placeholder:"e.g., Community Health Workshop",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"community",children:"Community *"}),(0,b.jsxs)(i.Select,{value:V.community,onValueChange:a=>W({...V,community:a}),children:[(0,b.jsx)(i.SelectTrigger,{id:"community",children:(0,b.jsx)(i.SelectValue,{placeholder:"Select community type"})}),(0,b.jsx)(i.SelectContent,{children:A.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:a},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"eventDate",children:"Event Date *"}),(0,b.jsx)(f.Input,{id:"eventDate",type:"date",value:V.eventDate,onChange:a=>W({...V,eventDate:a.target.value}),required:!0})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"location",children:"Location"}),(0,b.jsx)(f.Input,{id:"location",value:V.location,onChange:a=>W({...V,location:a.target.value}),placeholder:"e.g., Community Center"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"participants",children:"Number of Participants"}),(0,b.jsx)(f.Input,{id:"participants",type:"number",min:"0",value:V.participants,onChange:a=>W({...V,participants:a.target.value}),placeholder:"0"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"duration",children:"Duration"}),(0,b.jsx)(f.Input,{id:"duration",value:V.duration,onChange:a=>W({...V,duration:a.target.value}),placeholder:"e.g., 3 hours"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"description",children:"Event Description *"}),(0,b.jsx)(h.Textarea,{id:"description",value:V.description,onChange:a=>W({...V,description:a.target.value}),placeholder:"Provide a detailed description of the event, its activities, and impact...",rows:4,required:!0}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Provide comprehensive details about the event, activities conducted, and community impact."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"objectives",children:"Objectives"}),(0,b.jsx)(h.Textarea,{id:"objectives",value:V.objectives,onChange:a=>W({...V,objectives:a.target.value}),placeholder:"What were the goals and objectives of this event?",rows:3})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"outcomes",children:"Outcomes & Impact"}),(0,b.jsx)(h.Textarea,{id:"outcomes",value:V.outcomes,onChange:a=>W({...V,outcomes:a.target.value}),placeholder:"What were the results and impact of the event?",rows:3})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"gallery",children:"Gallery Images (optional)"}),(0,b.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-gray-400 transition-colors",children:Z.length>0?(0,b.jsx)("div",{className:"grid grid-cols-3 gap-4",children:Z.map((a,c)=>(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:a,alt:`Gallery preview ${c+1}`,className:"w-full h-24 object-cover rounded-lg"}),(0,b.jsx)(e.Button,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{let a,b;return a=V.galleryFiles.filter((a,b)=>b!==c),b=Z.filter((a,b)=>b!==c),void(W({...V,galleryFiles:a}),$(b))},children:(0,b.jsx)(u.default,{className:"h-4 w-4"})})]},c))}):(0,b.jsxs)("label",{htmlFor:"gallery",className:"flex flex-col items-center cursor-pointer",children:[(0,b.jsx)(t,{className:"h-12 w-12 text-gray-400 mb-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-600 mb-1",children:"Click to upload gallery images"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"PNG, JPG up to 5MB each"}),(0,b.jsx)(f.Input,{id:"gallery",type:"file",accept:"image/*",multiple:!0,onChange:a=>{let b=Array.from(a.target.files||[]);if(b.length+V.galleryFiles.length>10)return void w.toast.error("Maximum 10 gallery images allowed");let c=[],d=[];b.forEach(a=>{if(a.size>5242880)return void w.toast.error(`${a.name} is too large. Max size is 5MB`);if(!a.type.startsWith("image/"))return void w.toast.error(`${a.name} is not an image file`);c.push(a);let b=new FileReader;b.onloadend=()=>{d.push(b.result),d.length===c.length&&$([...Z,...d])},b.readAsDataURL(a)}),W({...V,galleryFiles:[...V.galleryFiles,...c]})},className:"hidden"})]})})]}),(0,b.jsx)("div",{className:"flex gap-2 pt-4",children:(0,b.jsxs)(e.Button,{type:"submit",className:"flex-1",children:[(0,b.jsx)(s.Upload,{className:"h-4 w-4 mr-2"}),"Save as Draft"]})})]})]})]})]}),(0,b.jsx)("div",{className:"border rounded-lg",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Event"}),(0,b.jsx)(j.TableHead,{children:"Community"}),(0,b.jsx)(j.TableHead,{children:"Date"}),(0,b.jsx)(j.TableHead,{children:"Status"}),(0,b.jsx)(j.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(j.TableBody,{children:0===ad.length?(0,b.jsx)(j.TableRow,{children:(0,b.jsx)(j.TableCell,{colSpan:5,className:"text-center text-gray-500 py-8",children:"No reports found. Create your first event report to get started."})}):ad.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[a.thumbnailUrl&&(0,b.jsx)("img",{src:a.thumbnailUrl,alt:a.eventName,className:"h-12 w-12 rounded object-cover"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.eventName}),a.location&&(0,b.jsx)("div",{className:"text-sm text-gray-500",children:a.location})]})]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(v.Badge,{variant:"outline",children:a.community})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Calendar,{className:"h-4 w-4 text-gray-400"}),new Date(a.eventDate).toLocaleDateString()]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(v.Badge,{className:(a=>{switch(a){case"Approved":return"bg-green-100 text-green-800";case"Submitted":return"bg-blue-100 text-blue-800";case"Draft":default:return"bg-gray-100 text-gray-800";case"Rejected":return"bg-red-100 text-red-800"}})(a.status),children:a.status})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>{S(a),Q(!0)},children:(0,b.jsx)(m.Eye,{className:"h-4 w-4"})}),"Draft"===a.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>aa(a.id),children:(0,b.jsx)(r,{className:"h-4 w-4 text-green-600"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:()=>ab(a.id),children:(0,b.jsx)(n.Trash2,{className:"h-4 w-4 text-red-600"})})]})]})})]},a.id))})]})})]}),(0,b.jsx)(x.TabsContent,{value:"all-reports",className:"space-y-4 mt-4",children:(0,b.jsx)(I,{reports:ac,currentUser:E,onReportsChange:z})})]})})]})}a.s(["EventReportManager",()=>Z],14226)}];

//# sourceMappingURL=src_components_EventReportManager_index_tsx_41f8a91e._.js.map